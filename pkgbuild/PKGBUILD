# Maintainer: Marcelo K. <elppansmk@...>
# shellcheck disable=all

pkgname=gnome-action-reimage
pkgver=$(date +%y.%m.%d)
pkgrel=$(date +%H%M)
arch=('any')
license=('GPL')
depends=('libjxl' 'imagemagick' 'jhead')
depends+=('gdm-settings')
url="https://github.com/elppans/gnome-action-reimage"
pkgdesc="Easily manipulate images and their metadata in action scripts."
source=("git+$url.git#branch=main")
md5sums=(SKIP)
install=${pkgname}.install

package() {
    # Verify default folder
    if [ -d "${srcdir}/${pkgname}/${pkgname}" ]; then
        InternalDir="${srcdir}/${pkgname}/${pkgname}"
    else
        InternalDir="${srcdir}/${pkgname}"
    fi


    # Copy files
    if [ -d "${InternalDir}/usr" ]; then
        cp -r "${InternalDir}/usr" "${pkgdir}/"
    fi

    if [ -d "${InternalDir}/etc" ]; then
        cp -r "${InternalDir}/etc" "${pkgdir}/"
    fi

    if [ -d "${InternalDir}/opt" ]; then
        cp -r "${InternalDir}/opt" "${pkgdir}/"
    fi
}
cat > "${pkgname}.install" <<EOF
post_install() {
/usr/bin/reimage-trans
case "$LANG" in
    pt_*)
        echo "O pacote \"${pkgname}\" foi instalado com sucesso."
        echo "Reinicie a sessão para que as configurações dos Action Scripts sejam aplicadas."
    ;;
    *)
        echo "The package \"${pkgname}\" was successfully installed."
        echo "Restart your session to apply the Action Scripts configuration."
    ;;
esac
}
post_upgrade() {
    post_install
}
post_remove() {
case "$LANG" in
    pt_*)
        echo "O \"${pkgname}\" foi removido."
    ;;
    *)
        echo "\"${pkgname}\" has been removed."
    ;;
esac
}
EOF
